<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: RSpec::Mocks::MessageExpectation
    &mdash; Documentation by YARD 0.9.37
</title>
  <link rel="stylesheet" href="/documentation/3.13/rspec-mocks/css/style.css" type="text/css" />
  <link rel="stylesheet" href="/documentation/3.13/rspec-mocks/css/common.css" type="text/css" />
<script type="text/javascript">
  pathId = "RSpec::Mocks::MessageExpectation";
  relpath = '../../';
</script>
  <script type="text/javascript" charset="utf-8" src="/documentation/3.13/rspec-mocks/js/jquery.js"></script>
  <script type="text/javascript" charset="utf-8" src="/documentation/3.13/rspec-mocks/js/app.js"></script>
  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>
    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
    <a href="../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../RSpec.html" title="RSpec (module)">RSpec</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Mocks.html" title="RSpec::Mocks (module)">Mocks</a></span></span>
     &raquo; 
    <span class="title">MessageExpectation</span>
</div>
        <div id="search">
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
</div>
        <div class="clear"></div>
      </div>
      <div id="content"><h1>Class: RSpec::Mocks::MessageExpectation
</h1>
<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
        <ul class="fullTree">
          <li>Object</li>
            <li class="next">RSpec::Mocks::MessageExpectation</li>
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
    </dd>
  </dl>
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rspec/mocks/message_expectation.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Represents an individual method stub or message expectation. The methods
defined here can be used to configure how it behaves. The methods return
<code>self</code> so that they can be chained together to form a fluent interface.</p>
  </div>
</div>
<div class="tags">
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="VerifyingMessageExpectation.html" title="RSpec::Mocks::VerifyingMessageExpectation (class)">VerifyingMessageExpectation</a></span></p>
</div>
    <h2>
      Configuring Responses
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>
    <ul class="summary">
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_call_original-instance_method" title="#and_call_original (instance method)">#<strong>and_call_original</strong>  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to delegate to the original unmodified method when it receives the message.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_invoke-instance_method" title="#and_invoke (instance method)">#<strong>and_invoke</strong>(first_proc, *procs, &amp;_block)  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to invoke a Proc when it receives the message.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_raise-instance_method" title="#and_raise (instance method)">#<strong>and_raise</strong>(*args)  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to raise an exception when the message is received.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_return-instance_method" title="#and_return (instance method)">#<strong>and_return</strong>(first_value, *values, &amp;_block)  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to return a value when it receives the message.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_throw-instance_method" title="#and_throw (instance method)">#<strong>and_throw</strong>(*args)  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to throw a symbol (with the object if that form is used) when the message is received.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_wrap_original-instance_method" title="#and_wrap_original (instance method)">#<strong>and_wrap_original</strong>(&amp;block)  &#x21d2; nil </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Decorates the stubbed method with the supplied block.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#and_yield-instance_method" title="#and_yield (instance method)">#<strong>and_yield</strong>(*args) {|@eval_context = Object.new| ... } &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Tells the object to yield one or more args to a block when the message is received.</p>
</div></span>
</li>
    </ul>
    <h2>
      Constraining Receive Counts
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>
    <ul class="summary">
        <li class="public ">
  <span class="summary_signature">
      <a href="#at_least-instance_method" title="#at_least (instance method)">#<strong>at_least</strong>(n, &amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Constrain a message expectation to be received at least a specific number of times.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#at_most-instance_method" title="#at_most (instance method)">#<strong>at_most</strong>(n, &amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Constrain a message expectation to be received at most a specific number of times.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#exactly-instance_method" title="#exactly (instance method)">#<strong>exactly</strong>(n, &amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Constrain a message expectation to be received a specific number of times.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#never-instance_method" title="#never (instance method)">#<strong>never</strong>  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Expect a message not to be received at all.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#once-instance_method" title="#once (instance method)">#<strong>once</strong>(&amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Expect a message to be received exactly one time.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#thrice-instance_method" title="#thrice (instance method)">#<strong>thrice</strong>(&amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Expect a message to be received exactly three times.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#times-instance_method" title="#times (instance method)">#<strong>times</strong>(&amp;block)  &#x21d2; MessageExpectation </a>
      (also: #time)
  </span>
    <span class="summary_desc"><div class='inline'><p>Syntactic sugar for <code>exactly</code>, <code>at_least</code> and <code>at_most</code>.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#twice-instance_method" title="#twice (instance method)">#<strong>twice</strong>(&amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Expect a message to be received exactly two times.</p>
</div></span>
</li>
    </ul>
    <h2>
      Other Constraints
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>
    <ul class="summary">
        <li class="public ">
  <span class="summary_signature">
      <a href="#ordered-instance_method" title="#ordered (instance method)">#<strong>ordered</strong>(&amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Expect messages to be received in a specific order.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; String </a>
      (also: #inspect)
  </span>
    <span class="summary_desc"><div class='inline'><p>A nice representation of the message expectation.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#with-instance_method" title="#with (instance method)">#<strong>with</strong>(*args, &amp;block)  &#x21d2; MessageExpectation </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Constrains a stub or message expectation to invocations with specific arguments.</p>
</div></span>
</li>
    </ul>
  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
      <div class="method_details first">
  <h3 class="signature first" id="and_call_original-instance_method">
    #<strong>and_call_original</strong>  &#x21d2; <tt>nil</tt> 
</h3><div class="docstring">
  <div class="discussion">
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This is only available on partial doubles.</p>
</div>
  </div>
<p>Tells the object to delegate to the original unmodified method
when it receives the message.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:increment</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_call_original'>and_call_original</span>
<span class='id identifier rubyid_original_count'>original_count</span> <span class='op'>=</span> <span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_original_count'>original_count</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
141
142
143
144
145
146
147
148</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 141</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_call_original'>and_call_original</span>
  <span class='id identifier rubyid_block'>block</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_original'>original</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span>
    <span class='id identifier rubyid_original'>original</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_block'>block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_ruby2_keywords'>ruby2_keywords</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:ruby2_keywords</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wrap_original'>wrap_original</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_invoke-instance_method">
    #<strong>and_invoke</strong>(first_proc, *procs, &amp;_block)  &#x21d2; <tt>nil</tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells the object to invoke a Proc when it receives the message. Given
more than one value, the result of the first Proc is returned the first
time the message is received, the result of the second Proc is returned
the next time, etc, etc.</p>
<p>If the message is received more times than there are Procs, the result of
the last Proc is returned for every subsequent call.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:get_foo</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_invoke'>and_invoke</span><span class='lparen'>(</span><span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ApiTimeout</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; raises ApiTimeout
</span><span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; raises ApiTimeout
</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:get_foo</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_invoke'>and_invoke</span><span class='lparen'>(</span><span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ApiTimeout</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ApiTimeout</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='symbol'>:a_foo</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; raises ApiTimeout
</span><span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; raises ApiTimeout
</span><span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; :a_foo
</span><span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; :a_foo
</span><span class='id identifier rubyid_api'>api</span><span class='period'>.</span><span class='id identifier rubyid_get_foo'>get_foo</span> <span class='comment'># =&gt; :a_foo
</span><span class='comment'># etc</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 109</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_invoke'>and_invoke</span><span class='lparen'>(</span><span class='id identifier rubyid_first_proc'>first_proc</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_procs'>procs</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid__block'>_block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_negative?'>negative?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`and_invoke` is not supported with negative message expectations</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Implementation blocks aren&#39;t supported with `and_invoke`</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_procs'>procs</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='id identifier rubyid_first_proc'>first_proc</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_procs'>procs</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:call</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Arguments to `and_invoke` must be callable.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@expected_received_count</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@expected_received_count</span><span class='comma'>,</span> <span class='id identifier rubyid_procs'>procs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ignoring_args?'>ignoring_args?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='ivar'>@expected_received_count</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@at_least</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>AndInvokeImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_procs'>procs</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_raise-instance_method">
      <span class="overload">#<strong>and_raise</strong>  &#x21d2; <tt>nil</tt> </span>
      <span class="overload">#<strong>and_raise</strong>(ExceptionClass)  &#x21d2; <tt>nil</tt> </span>
      <span class="overload">#<strong>and_raise</strong>(ExceptionClass, message)  &#x21d2; <tt>nil</tt> </span>
      <span class="overload">#<strong>and_raise</strong>(exception_instance)  &#x21d2; <tt>nil</tt> </span>
</h3><div class="docstring">
  <div class="discussion">
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>When you pass an exception class, the MessageExpectation will raise
an instance of it, creating it with <code>exception</code> and passing <code>message</code>
if specified.  If the exception class initializer requires more than
one parameters, you must pass in an instance and not the class,
otherwise this method will raise an ArgumentError exception.</p>
</div>
  </div>
<p>Tells the object to raise an exception when the message is received.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>At least 2 oz of gas needed to drive</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='symbol'>:oz</span><span class='rparen'>)</span><span class='rparen'>)</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
186
187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 186</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_return-instance_method">
      <span class="overload">#<strong>and_return</strong>(value)  &#x21d2; <tt>nil</tt> </span>
      <span class="overload">#<strong>and_return</strong>(first_value, second_value)  &#x21d2; <tt>nil</tt> </span>
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells the object to return a value when it receives the message.  Given
more than one value, the first value is returned the first time the
message is received, the second value is returned the next time, etc,
etc.</p>
<p>If the message is received more times than there are values, the last
value is returned for every subsequent call.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 2
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='comment'># etc</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 71</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='id identifier rubyid_first_value'>first_value</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_values'>values</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid__block'>_block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_negative?'>negative?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`and_return` is not supported with negative message expectations</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Implementation blocks aren&#39;t supported with `and_return`</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='id identifier rubyid_first_value'>first_value</span><span class='rparen'>)</span>
  <span class='ivar'>@expected_received_count</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@expected_received_count</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ignoring_args?'>ignoring_args?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='ivar'>@expected_received_count</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@at_least</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>AndReturnImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_throw-instance_method">
      <span class="overload">#<strong>and_throw</strong>(symbol)  &#x21d2; <tt>nil</tt> </span>
      <span class="overload">#<strong>and_throw</strong>(symbol, object)  &#x21d2; <tt>nil</tt> </span>
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells the object to throw a symbol (with the object if that form is
used) when the message is received.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='symbol'>:out_of_gas</span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='symbol'>:out_of_gas</span><span class='comma'>,</span> <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='float'>0.1</span><span class='rparen'>)</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 202</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_throw'>throw</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_wrap_original-instance_method">
    #<strong>and_wrap_original</strong>(&amp;block)  &#x21d2; <tt>nil</tt> 
</h3><div class="docstring">
  <div class="discussion">
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This is only available on partial doubles.</p>
</div>
  </div>
<p>Decorates the stubbed method with the supplied block. The original
unmodified method is passed to the block along with any method call
arguments so you can delegate to it, whilst still being able to
change what args are passed to it and/or change the return value.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:large_list</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_wrap_original'>and_wrap_original</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_original_method'>original_method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='op'>|</span>
  <span class='id identifier rubyid_original_method'>original_method</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>nil</tt>)</span>
        &mdash;
        <div class='inline'><p>No further chaining is supported after this.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
162
163
164</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 162</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_wrap_original'>and_wrap_original</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wrap_original'>wrap_original</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="and_yield-instance_method">
    #<strong>and_yield</strong>(*args) {|@eval_context = Object.new| ... } &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells the object to yield one or more args to a block when the message
is received.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_stub'>stub</span><span class='lparen'>(</span><span class='symbol'>:open</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_yield'>and_yield</span><span class='lparen'>(</span><span class='const'>StringIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span></code></pre>
  </div>
<p class="tag_title">Yields:</p>
<ul class="yield">
    <li>
        <span class='type'>(<tt>@eval_context = Object.new</tt>)</span>
    </li>
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
214
215
216
217
218
219
220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 214</span>
<span class='kw'>def</span> <span class='id identifier rubyid_and_yield'>and_yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>yield</span> <span class='ivar'>@eval_context</span> <span class='op'>=</span> <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
  <span class='comment'># Initialize args to yield now that it&#39;s being used, see also: comment
</span>  <span class='comment'># in constructor.
</span>  <span class='ivar'>@args_to_yield</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@args_to_yield</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_initial_implementation_action'>initial_implementation_action</span> <span class='op'>=</span> <span class='const'>AndYieldImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@args_to_yield</span><span class='comma'>,</span> <span class='ivar'>@eval_context</span><span class='comma'>,</span> <span class='ivar'>@error_generator</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="at_least-instance_method">
    #<strong>at_least</strong>(n, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Constrain a message expectation to be received at least a specific
number of times.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='int'>9</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
249
250
251
252
253
254
255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 249</span>
<span class='kw'>def</span> <span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:at_least</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>at_least(0) has been removed, use allow(...).to receive(:message) instead</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="at_most-instance_method">
    #<strong>at_most</strong>(n, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Constrain a message expectation to be received at most a specific
number of times.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
268
269
270
271
272
273</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 268</span>
<span class='kw'>def</span> <span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:at_most</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="exactly-instance_method">
    #<strong>exactly</strong>(n, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Constrain a message expectation to be received a specific number of
times.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
236
237
238
239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 236</span>
<span class='kw'>def</span> <span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="never-instance_method">
    #<strong>never</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Expect a message not to be received at all.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:stop</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_never'>never</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 293</span>
<span class='kw'>def</span> <span class='id identifier rubyid_never'>never</span>
  <span class='id identifier rubyid_error_generator'>error_generator</span><span class='period'>.</span><span class='id identifier rubyid_raise_double_negation_error'>raise_double_negation_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expect(obj)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_negative?'>negative?</span>
  <span class='ivar'>@expected_received_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="once-instance_method">
    #<strong>once</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Expect a message to be received exactly one time.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_once'>once</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
304
305
306
307
308</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 304</span>
<span class='kw'>def</span> <span class='id identifier rubyid_once'>once</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>1</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="ordered-instance_method">
    #<strong>ordered</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Expect messages to be received in a specific order.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:prepare</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:run</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:finish</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 379</span>
<span class='kw'>def</span> <span class='id identifier rubyid_ordered'>ordered</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:stub</span>
    <span class='const'><span class='object_link'><a href="../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warning'>warning</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`allow(...).to receive(..).ordered` is not supported and will </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>have no effect, use `and_return(*ordered_values)` instead.</span><span class='tstring_end'>&quot;</span></span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_additional_expected_calls'>additional_expected_calls</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='ivar'>@order_group</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@ordered</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="thrice-instance_method">
    #<strong>thrice</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Expect a message to be received exactly three times.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_thrice'>thrice</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
326
327
328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 326</span>
<span class='kw'>def</span> <span class='id identifier rubyid_thrice'>thrice</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>3</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="times-instance_method">
    #<strong>times</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
    <span class="aliases">Also known as:
    <span class="names"><span id='time-instance_method'>time</span></span>
    </span>
</h3><div class="docstring">
  <div class="discussion">
    <p>Syntactic sugar for <code>exactly</code>, <code>at_least</code> and <code>at_most</code></p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
282
283
284
285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 282</span>
<span class='kw'>def</span> <span class='id identifier rubyid_times'>times</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
    #<strong>to_s</strong>  &#x21d2; <tt>String</tt> 
    <span class="aliases">Also known as:
    <span class="names"><span id='inspect-instance_method'>inspect</span></span>
    </span>
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a nice representation of the message expectation.</p>
  </div>
</div>
<div class="tags">
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>String</tt>)</span>
        &mdash;
        <div class='inline'><p>a nice representation of the message expectation</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
396
397
398
399
400</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 396</span>
<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_args_description'>args_description</span> <span class='op'>=</span> <span class='id identifier rubyid_error_generator'>error_generator</span><span class='period'>.</span><span class='id identifier rubyid_method_call_args_description'>method_call_args_description</span><span class='lparen'>(</span><span class='ivar'>@argument_list_matcher</span><span class='period'>.</span><span class='id identifier rubyid_expected_args'>expected_args</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_args_description'>args_description</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args_description'>args_description</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_args_description'>args_description</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error_generator'>error_generator</span><span class='period'>.</span><span class='id identifier rubyid_intro'>intro</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args_description'>args_description</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="twice-instance_method">
    #<strong>twice</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Expect a message to be received exactly two times.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_twice'>twice</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
315
316
317
318
319</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 315</span>
<span class='kw'>def</span> <span class='id identifier rubyid_twice'>twice</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>2</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="with-instance_method">
    #<strong>with</strong>(*args, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p>Constrains a stub or message expectation to invocations with specific
arguments.</p>
<p>With a stub, if the message might be received with other args as well,
you should stub a default value first, and then stub or mock the same
message using <code>with</code> to constrain to specific arguments.</p>
<p>A message expectation will fail if the message is received with different
arguments.</p>
  </div>
</div>
<div class="tags">
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
      <pre class="example code"><code><span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:failure</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_allow'><span class='object_link'><a href="ExampleMethods.html#allow-instance_method" title="RSpec::Mocks::ExampleMethods#allow (method)">allow</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:success</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1234567890</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; :failure
</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; :success
</span>
<span class='id identifier rubyid_expect'><span class='object_link'><a href="ExampleMethods.html#expect-instance_method" title="RSpec::Mocks::ExampleMethods#expect (method)">expect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'><span class='object_link'><a href="ExampleMethods.html#receive-instance_method" title="RSpec::Mocks::ExampleMethods#receive (method)">receive</a></span></span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:success</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1234567890</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; failed expectation
</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; passes</span></code></pre>
  </div>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
        &mdash;
        <div class='inline'><p>self, to support further chaining.</p>
</div>
    </li>
</ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
359
360
361
362
363
364
365
366
367
368
369</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 359</span>
<span class='kw'>def</span> <span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`with` must have at least one argument. Use `no_args` matcher to set the expectation of receiving no arguments.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@argument_list_matcher</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ArgumentListMatcher.html" title="RSpec::Mocks::ArgumentListMatcher (class)">ArgumentListMatcher</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ArgumentListMatcher.html#initialize-instance_method" title="RSpec::Mocks::ArgumentListMatcher#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  </div>
</div>
      <div id="footer">
  Generated on Wed Sep  4 15:23:12 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.2).
</div>
    </div>
  </body>
</html>