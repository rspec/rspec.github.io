<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: RSpec::Mocks::ConstantMutator
    &mdash; Documentation by YARD 0.9.37
</title>
  <link rel="stylesheet" href="/documentation/3.13/rspec-mocks/css/style.css" type="text/css" />
  <link rel="stylesheet" href="/documentation/3.13/rspec-mocks/css/common.css" type="text/css" />
<script type="text/javascript">
  pathId = "RSpec::Mocks::ConstantMutator";
  relpath = '../../';
</script>
  <script type="text/javascript" charset="utf-8" src="/documentation/3.13/rspec-mocks/js/jquery.js"></script>
  <script type="text/javascript" charset="utf-8" src="/documentation/3.13/rspec-mocks/js/app.js"></script>
  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>
    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../RSpec.html" title="RSpec (module)">RSpec</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Mocks.html" title="RSpec::Mocks (module)">Mocks</a></span></span>
     &raquo; 
    <span class="title">ConstantMutator</span>
</div>
        <div id="search">
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
</div>
        <div class="clear"></div>
      </div>
      <div id="content"><h1>Class: RSpec::Mocks::ConstantMutator
</h1>
<div class="box_info">
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
        <ul class="fullTree">
          <li>Object</li>
            <li class="next">RSpec::Mocks::ConstantMutator</li>
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
    </dd>
  </dl>
  <dl>
      <dt>Extended by:</dt>
      <dd>Support::RecursiveConstMethods</dd>
  </dl>
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rspec/mocks/mutate_const.rb</dd>
  </dl>
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Provides a means to stub constants.</p>
  </div>
</div>
<div class="tags">
</div>
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>
    <ul class="summary">
        <li class="public ">
  <span class="summary_signature">
      <a href="#hide-class_method" title="hide (class method)">.<strong>hide</strong>(constant_name)  &#x21d2; Object </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Hides a constant.</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#raise_on_invalid_const-class_method" title="raise_on_invalid_const (class method)">.<strong>raise_on_invalid_const</strong>  &#x21d2; Object </a>
  </span>
  <span class="private note title">private</span>
    <span class="summary_desc"><div class='inline'><p>Used internally by the constant stubbing to raise a helpful error when a constant like &quot;A::B::C&quot; is stubbed and A::B is not a module (and thus, it&#39;s impossible to define &quot;A::B::C&quot; since only modules can have nested constants).</p>
</div></span>
</li>
        <li class="public ">
  <span class="summary_signature">
      <a href="#stub-class_method" title="stub (class method)">.<strong>stub</strong>(constant_name, value, options = {})  &#x21d2; Object </a>
  </span>
    <span class="summary_desc"><div class='inline'><p>Stubs a constant.</p>
</div></span>
</li>
    </ul>
  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
      <div class="method_details first">
  <h3 class="signature first" id="hide-class_method">
    .<strong>hide</strong>(constant_name)  &#x21d2; <tt>Object</tt> 
</h3><div class="docstring">
  <div class="discussion">
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>It&#39;s recommended that you use <code>hide_const</code> in your
examples. This is an alternate public API that is provided
so you can hide constants in other contexts (e.g. helper
classes).</p>
</div>
  </div>
<p>Hides a constant.</p>
  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
    <li>
        <span class='name'>constant_name</span>
        <span class='type'>(<tt>String</tt>)</span>
        &mdash;
        <div class='inline'><p>The fully qualified name of the constant.
The current constant scoping at the point of call is not considered.</p>
</div>
    </li>
</ul>
  <p class="tag_title">See Also:</p>
  <ul class="see">
      <li><span class='object_link'><a href="ExampleMethods.html#hide_const-instance_method" title="RSpec::Mocks::ExampleMethods#hide_const (method)">ExampleMethods#hide_const</a></span></li>
  </ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/mutate_const.rb', line 131</span>
<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hide'>hide</span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mutate'>mutate</span><span class='lparen'>(</span><span class='const'>ConstantHider</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="raise_on_invalid_const-class_method">
    .<strong>raise_on_invalid_const</strong>  &#x21d2; <tt>Object</tt> 
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Used internally by the constant stubbing to raise a helpful
error when a constant like &quot;A::B::C&quot; is stubbed and A::B is
not a module (and thus, it&#39;s impossible to define &quot;A::B::C&quot;
since only modules can have nested constants).</p>
  </div>
</div>
<div class="tags">
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
331
332
333
334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/mutate_const.rb', line 331</span>
<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_raise_on_invalid_const'>raise_on_invalid_const</span>
  <span class='id identifier rubyid_lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_const_name'>const_name</span><span class='comma'>,</span> <span class='id identifier rubyid_failed_name'>failed_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot stub constant </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_failed_name'>failed_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_const_name'>const_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> \
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>since </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_const_name'>const_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a module.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
      <div class="method_details ">
  <h3 class="signature " id="stub-class_method">
    .<strong>stub</strong>(constant_name, value, options = {})  &#x21d2; <tt>Object</tt> 
</h3><div class="docstring">
  <div class="discussion">
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>It&#39;s recommended that you use <code>stub_const</code> in your
examples. This is an alternate public API that is provided
so you can stub constants in other contexts (e.g. helper
classes).</p>
</div>
  </div>
<p>Stubs a constant.</p>
  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
    <li>
        <span class='name'>constant_name</span>
        <span class='type'>(<tt>String</tt>)</span>
        &mdash;
        <div class='inline'><p>The fully qualified name of the constant. The current
constant scoping at the point of call is not considered.</p>
</div>
    </li>
    <li>
        <span class='name'>value</span>
        <span class='type'>(<tt>Object</tt>)</span>
        &mdash;
        <div class='inline'><p>The value to make the constant refer to. When the
example completes, the constant will be restored to its prior state.</p>
</div>
    </li>
    <li>
        <span class='name'>options</span>
        <span class='type'>(<tt>Hash</tt>)</span>
        <em class="default">(defaults to: <tt>{}</tt>)</em>
        &mdash;
        <div class='inline'><p>Stubbing options.</p>
</div>
    </li>
</ul>
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
        <li>
          <span class="name">:transfer_nested_constants</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
          <span class="default">
          </span>
            &mdash; <div class='inline'><p>Determines
what nested constants, if any, will be transferred from the original value
of the constant to the new value of the constant. This only works if both
the original and new values are modules (or classes).</p>
</div>
        </li>
    </ul>
<p class="tag_title">Returns:</p>
<ul class="return">
    <li>
        <span class='type'>(<tt>Object</tt>)</span>
        &mdash;
        <div class='inline'><p>the stubbed value of the constant</p>
</div>
    </li>
</ul>
  <p class="tag_title">See Also:</p>
  <ul class="see">
      <li><span class='object_link'><a href="ExampleMethods.html#stub_const-instance_method" title="RSpec::Mocks::ExampleMethods#stub_const (method)">ExampleMethods#stub_const</a></span></li>
  </ul>
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">
107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/mutate_const.rb', line 107</span>
<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_stub'><span class='object_link'><a href="../../top-level-namespace.html#stub-instance_method" title="#stub (method)">stub</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_constant_name'>constant_name</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`stub_const` requires a String, but you provided a </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_mutator'>mutator</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_recursive_const_defined?'>recursive_const_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_raise_on_invalid_const'>raise_on_invalid_const</span><span class='rparen'>)</span>
              <span class='const'>DefinedConstantReplacer</span>
            <span class='kw'>else</span>
              <span class='const'>UndefinedConstantSetter</span>
            <span class='kw'>end</span>
  <span class='id identifier rubyid_mutate'>mutate</span><span class='lparen'>(</span><span class='id identifier rubyid_mutator'>mutator</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:transfer_nested_constants</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  </div>
</div>
      <div id="footer">
  Generated on Wed Sep  4 15:23:12 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.2).
</div>
    </div>
  </body>
</html>